(()=>{"use strict";const d="https://ouxnadpkm4.execute-api.us-east-1.amazonaws.com/shopify";var e=document.getElementById("form-budget-step-1");const l={500:"Ops, ocorreu um erro ao processar sua solicitação. Por favor, tente novamente mais tarde ou entre em contato com nosso time.",password:"As senhas fornecidas não são iguais. Por favor, verifique e tente novamente."};function c(e,t){gsap.to(e,{display:"none",opacity:0,duration:.3,onComplete:()=>{gsap.to(t,{display:"flex",opacity:1,duration:.2})}})}function m(e,t){e=document.getElementById(e);e.querySelector(".alert-message").innerText=t,gsap.to(e,{display:"block",opacity:1,duration:.3})}e.addEventListener("submit",async e=>{e.preventDefault();e=e.currentTarget;if(e.checkValidity()){var t=e.querySelector('button[type="submit"]');t.disabled=!0,t.innerText="Enviando...";e=new FormData(e).get("email");try{var a=await async function(e){var t=new Headers,t=(t.append("Content-Type","application/json"),{method:"POST",headers:t,body:JSON.stringify({email:e}),redirect:"follow"}),e=await fetch(d+"/verify",t);if(e.ok)return e.text();throw new Error("Network response was not ok.")}(e),{status:r,message:n}=JSON.parse(a);200===Number(r)?(document.getElementById("email-send").innerText=e,c("#hero","#form-2ft")):500<=Number(r)?m("alert-send-email",l[500]):300<=Number(r)&&m("alert-send-email",n)}catch(e){console.error(e),m("alert-send-email",l[500])}finally{t.disabled=!1,t.innerText="Iniciar Cadastro"}}}),document.getElementById("form-budget-step-2").addEventListener("submit",async e=>{e.preventDefault();e=e.currentTarget;if(e.checkValidity()){var t=e.querySelector('button[type="submit"]'),a=(t.disabled=!0,t.innerText="Validando...",new FormData(e)),r={};for(let e=1;e<=6;e++)r["c"+e]=a.get("code"+e);var e=Object.values(r).join(""),n=document.getElementById("email-send").innerText;try{var o=await async function(e,t){var a=new Headers,a=(a.append("Content-Type","application/json"),{method:"POST",headers:a,body:JSON.stringify({email:e,code:t}),redirect:"follow"}),e=await fetch(d+"/validate",a);if(e.ok)return e.text();throw new Error("Network response was not ok.")}(n,e),{status:s,message:i}=JSON.parse(o);200===Number(s)?(document.getElementById("code-singup").value=e,document.getElementById("email-singup").value=n,c("#form-2ft","#form-singup")):500<=Number(s)?m("alert-validade-code",l[500]):300<=Number(s)&&m("alert-validade-code",i)}catch(e){console.error(e),m("alert-validade-code",l[500])}finally{t.disabled=!1,t.innerText="Validar token"}}}),document.getElementById("form-budget-step-3").addEventListener("submit",async e=>{e.preventDefault();e=e.currentTarget;if(e.checkValidity()){var t=e.querySelector('button[type="submit"]'),a=(t.disabled=!0,t.innerText="Criando...",new FormData(e));if(a.get("password")!=a.get("confirm-password"))t.disabled=!1,t.innerText="Criar conta",m("alert-singup",l.password);else{a={code:a.get("code"),email:a.get("email"),first_name:a.get("first_name"),last_name:a.get("last_name"),cpf:a.get("cpf"),birthday:a.get("birth-data"),gender:a.get("gender"),phone:a.get("phone"),password:a.get("password"),password_confirm:a.get("confirm-password"),optin:"on"===a.get("optin")?1:0};try{var r,n=await async function(e){var t=new Headers,t=(t.append("Content-Type","application/json"),{method:"POST",headers:t,body:JSON.stringify(e),redirect:"follow"}),e=await fetch(d+"/validate",t);if(e.ok)return e.text();throw new Error("Network response was not ok.")}(a),{status:o,message:s}=JSON.parse(n);200===Number(o)?(e.reset(),r="modal-success",r=document.getElementById(r),(r=new bootstrap.Modal(r)).show()):500<=Number(o)?m("alert-singup",l[500]):300<=Number(o)&&m("alert-singup",s)}catch(e){console.error(e),m("alert-singup",l[500])}finally{t.disabled=!1,t.innerText="Criar conta"}}}}),document.querySelectorAll(".alert .btn-close").forEach(t=>{t.addEventListener("click",()=>{var e=t.closest(".alert");gsap.to(e,{display:"none",opacity:0,duration:.3})})})})();